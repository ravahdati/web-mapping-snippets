<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CedarMaps Implementation</title>
    <link href='https://api.cedarmaps.com/cedarmaps.js/v1.8.1/cedarmaps.css' rel='stylesheet' />
    
    <style>
        #map_h9sisi {
			position: relative;
			width: 600px;
			height: 400px;
			max-width: 100%;
			background-color: #eee;
        }
    </style>
</head>
<body>

    <div id="map_h9sisi"></div>

    <script>
        const mapConfig = {
            containerId: 'map_h9sisi',
            accessToken: 'https://api.cedarmaps.com/v1/tiles/cedarmaps.streets.json?access_token={YOUR_ACCESS_TOKEN}',
            options: {
                center: { lat: 35.681009, lng: 51.401744 },
                maptype: "light",
                scrollWheelZoom: false,
                zoomControl: true,
                zoom: 17,
                minZoom: 6,
                maxZoom: 17,
                legendControl: false,
                attributionControl: false
            },
            markers: [
                {
                    popupContent: "Tehran",
                    center: { lat: 35.681009, lng: 51.401744 },
                    iconOpts: {
                        iconUrl: "https://api.cedarmaps.com/v1/markers/marker-default.png",
                        iconRetinaUrl: "https://api.cedarmaps.com/v1/markers/marker-default@2x.png",
                        iconSize: [82, 98]
                    }
                }
            ]
        };

        function initMap() {
            if (!window.L || !window.L.cedarmaps) {
                console.error("CedarMaps SDK not loaded.");
                return;
            }

            var map = window.L.cedarmaps.map(
                mapConfig.containerId, 
                mapConfig.accessToken, 
                mapConfig.options
            );

            map.setView(mapConfig.options.center, mapConfig.options.zoom);

            if (mapConfig.markers.length > 0) {
                var markersLeaflet = [];

                mapConfig.markers.forEach(function(markerData) {
                    var iconOpts = {
                        iconUrl: markerData.iconOpts.iconUrl,
                        iconRetinaUrl: markerData.iconOpts.iconRetinaUrl,
                        iconSize: markerData.iconOpts.iconSize,
                        popupAnchor: [0, -49]
                    };

                    var markerIcon = { icon: window.L.icon(iconOpts) };
                    var _marker = new window.L.marker(markerData.center, markerIcon);
                    
                    if (markerData.popupContent) {
                        _marker.bindPopup(markerData.popupContent);
                    }
                    
                    _marker.addTo(map);
                    markersLeaflet.push(_marker);
                });

                if (markersLeaflet.length > 1) {
                    var group = new window.L.featureGroup(markersLeaflet);
                    map.fitBounds(group.getBounds(), { padding: [30, 30] });
                }
            }
        }

        (function(d, s, url, callback) {
            var script = d.createElement(s);
            script.async = true;
            script.src = url;
            script.onload = callback;
            d.body.appendChild(script);
        })(document, 'script', 'https://api.cedarmaps.com/cedarmaps.js/v1.8.1/cedarmaps.js', initMap);
    </script>
</body>
</html>